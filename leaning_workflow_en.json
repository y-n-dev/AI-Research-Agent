{
  "name": "leaning_workflow_en",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -40,
        -40
      ],
      "id": "8209d4cb-2f70-4e96-82d3-1e35b083076e",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        860,
        460
      ],
      "id": "0a455837-adfe-4851-a09f-f866ce29068c",
      "name": "Anthropic Chat Model",
      "credentials": {
        "anthropicApi": {
          "id": "ThLg5qkcjtu1d3nA",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 234951073,
          "mode": "list",
          "cachedResultName": "research_history",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=234951073"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -20,
        240
      ],
      "id": "064fc2cc-c4df-4000-8706-0003644a64ef",
      "name": "Research History Reading",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "ğŸŒ± Weekly learning time! âœ¨\n\nReflecting on this week's research to grow! \n Please wait a moment ğŸ¤–ğŸ’­",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        500,
        -40
      ],
      "id": "aa9395ae-b472-4af3-8715-0baf842a2e11",
      "name": "Learning Start Notification",
      "webhookId": "ab672458-ce0b-46b0-85c7-aa9601b5bbd5",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "config",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        120,
        -40
      ],
      "id": "23c22be8-16a0-4c7d-9bb1-a519b335280e",
      "name": "Config Reading",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 10å€‹ã®è¨­å®šé …ç›®ã‚’1ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¾ã¨ã‚ã‚‹\nconst settings = {};\nfor (const item of $input.all()) {\n  settings[item.json.key] = item.json.value;\n}\n\nreturn [{ settings }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        300,
        -40
      ],
      "id": "911cfc4e-903b-46c5-9b43-a328d3d805e5",
      "name": "Config Object Creation"
    },
    {
      "parameters": {
        "jsCode": "// å…¨ã¦ã®èª¿æŸ»å±¥æ­´ã‚’1ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¾ã¨ã‚ã‚‹\nconst allData = $input.all();\nreturn [{ \n  totalCount: allData.length,\n  allRecords: allData,\n  summary: `èª¿æŸ»å±¥æ­´${allData.length}ä»¶ã‚’ã¾ã¨ã‚ã¾ã—ãŸ`\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        220,
        240
      ],
      "id": "f2180ba0-25f9-4e2f-844c-89095568d8d5",
      "name": "Research History Object Creation"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 911248991,
          "mode": "list",
          "cachedResultName": "prompt_management",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=911248991"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "is_active",
              "lookupValue": "true"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        460,
        240
      ],
      "id": "82b73b2c-362c-4d91-b3fa-7dfa39ae154a",
      "name": "Current Prompt Reading",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ã‚ãªãŸã¯AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å­¦ç¿’åˆ†ææ‹…å½“ã§ã™ã€‚\n\nä»¥ä¸‹ã¯èª¿æŸ»å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã§ã™ï¼š\n{{ JSON.stringify($('Research History Object Creation').item.json.allRecords, null, 2) }}\n\nç·ä»¶æ•°: {{ $('Research History Object Creation').item.json.totalCount }}ä»¶\n\n**â€»é‡è¦: ç›´è¿‘7æ—¥é–“ï¼ˆ{{ $now.minus({days: 7}).toFormat('yyyy/M/d') }}ä»¥é™ï¼‰ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’åˆ†æã—ã¦ãã ã•ã„**\n**â€»ãã‚Œã‚ˆã‚Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã¯ç„¡è¦–ã—ã¦ãã ã•ã„**\n\nä¸Šè¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ã€ä»Šé€±ã®å­¦ç¿’ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š\n\nğŸŒ± **ä»Šé€±ã®å­¦ç¿’ãƒ¬ãƒãƒ¼ãƒˆ**\n\nğŸ“Š **èª¿æŸ»å®Ÿç¸¾**\n- ç·èª¿æŸ»ä»¶æ•°: {{ $('Research History Object Creation').item.json.totalCount }}ä»¶\n- ã‚«ãƒ†ã‚´ãƒªåˆ¥é›†è¨ˆ\n\nğŸ’­ **ä»Šé€±è¦šãˆãŸã“ã¨**\n- å…¨èª¿æŸ»ã‚’é€šã—ã¦å­¦ã‚“ã ã“ã¨\n- èª¿æŸ»ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‚¾å‘\n- æˆé•·ãƒã‚¤ãƒ³ãƒˆ\n\nâœ¨ **ã²ã¨ã“ã¨**\n- AIã¡ã‚ƒã‚“ã‚‰ã—ã„å¯æ„›ã„ã‚³ãƒ¡ãƒ³ãƒˆ\n\nâ€»å­¦ç¿’ãƒ¬ãƒãƒ¼ãƒˆã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        640,
        240
      ],
      "id": "3ec0c5cb-e6fe-4172-9de3-840a0c1af51a",
      "name": "Learning Analysis"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 705924613,
          "mode": "list",
          "cachedResultName": "learning_data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=705924613"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "learning_date": "={{ new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}",
            "learning_content": "={{ $('Learning Analysis').item.json.text }}",
            "prompt_version": "={{ $('Current Prompt Reading').item.json[\"version\"] }}"
          },
          "matchingColumns": [
            "learning_date"
          ],
          "schema": [
            {
              "id": "learning_date",
              "displayName": "learning_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "learning_content",
              "displayName": "learning_content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "improvement_judgment",
              "displayName": "improvement_judgment",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "prompt_version",
              "displayName": "prompt_version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        920,
        120
      ],
      "id": "bd4eeaeb-c17f-4a18-963d-90c0f1e0aaca",
      "name": "Learning Result Save",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ã‚ãªãŸã¯AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ”¹è‰¯åˆ¤å®šå°‚é–€å®¶ã§ã™ã€‚\n\n## ä»Šé€±ã®å­¦ç¿’åˆ†æçµæœ\n{{ $('Learning Analysis').item.json.text }}\n\n## ç¾åœ¨ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\n{{ $('Current Prompt Reading').item.json['ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡'] }}\n\nä¸Šè¨˜ã®å­¦ç¿’çµæœã¨ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ¯”è¼ƒåˆ†æã—ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ”¹è‰¯ãŒå¿…è¦ã‹ã©ã†ã‹åˆ¤å®šã—ã¦ãã ã•ã„ã€‚\n\nå›ç­”ã¯ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®ã¿ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š\n- æ”¹è‰¯å¿…è¦\n- æ”¹è‰¯ä¸è¦",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1020,
        240
      ],
      "id": "18001963-3176-4f51-881d-ad1e8b990e0e",
      "name": "Improvement Necessity Assessment"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.text }}",
                    "rightValue": "æ”¹è‰¯å¿…è¦",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "0893c439-29a7-475a-8c61-2e07ff608fd3"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "60ffa663-305f-4c6e-90c1-edfda9aea25a",
                    "leftValue": "={{ $json.text }} contains æ”¹è‰¯ä¸è¦",
                    "rightValue": "æ”¹è‰¯ä¸è¦",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "58574a74-7d92-4f33-9638-211fcd5f3aa6",
                    "leftValue": "",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1380,
        240
      ],
      "id": "c29b31e4-8a9f-41eb-9bf9-c5cb056ef6f7",
      "name": "Improvement Decision Switch"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ã‚ãªãŸã¯AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹è‰¯å°‚é–€å®¶ã§ã™ã€‚\n\n## ç¾åœ¨ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\n{{ JSON.stringify($('Current Prompt Reading').item.json, null, 2) }}\n\n## éå»ã®èª¿æŸ»å±¥æ­´\n{{ JSON.stringify($('Research History Object Creation').item.json.allRecords, null, 2) }}\n\n## å­¦ç¿’åˆ†æçµæœ\n{{ $('Learning Analysis').item.json.text }}\n\nä¸Šè¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ã€ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ”¹è‰¯ç‰ˆã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚\n\nğŸ”§ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹è‰¯åˆ†æ\n- ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å¼·ã¿\n- èª¿æŸ»çµæœã‹ã‚‰è¦‹ã¤ã‘ãŸæ”¹è‰¯ç‚¹\n- å…·ä½“çš„ãªæ”¹è‰¯ææ¡ˆ\n\nğŸ’¡ æ”¹è‰¯ç‰ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\nç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ”¹è‰¯ã—ãŸæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä»¥ä¸‹ã®å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š\n\nâ€»æ”¹è‰¯ç‰ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†…å®¹ã®ã¿ã‚’å‡ºåŠ›ã—ã€åˆ†æçµæœã¯å«ã‚ãªã„ã§ãã ã•ã„ã€‚\n\næ”¹è‰¯ç‰ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼š",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1600,
        260
      ],
      "id": "d4413916-340c-4a9f-ab44-7a613b9c5cd6",
      "name": "Prompt Improvement"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "=ğŸ“‹ This week's learning summary âœ¨\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n{{ $('Learning Analysis').item.json.text }}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nLooking forward to next week! ğŸ¤–ğŸ’­",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1920,
        260
      ],
      "id": "7dfe0add-43af-4da4-8d3f-540a07976df2",
      "name": "Learning Content Notification",
      "webhookId": "c6b60df9-f871-403d-a744-7735f976c476",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 911248991,
          "mode": "list",
          "cachedResultName": "prompt_management",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=911248991"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "version": "={{ $('Current Prompt Reading').item.json['version'] }}",
            "current_prompt_text": "=$('Prompt Improvement').item.json.text",
            "is_active": "FALSE"
          },
          "matchingColumns": [
            "version"
          ],
          "schema": [
            {
              "id": "prompt_name",
              "displayName": "prompt_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_prompt_text",
              "displayName": "current_prompt_text",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "version",
              "displayName": "version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "update_date",
              "displayName": "update_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "improvement_reason",
              "displayName": "improvement_reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "is_active",
              "displayName": "is_active",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "character_limit",
              "displayName": "character_limit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        2080,
        260
      ],
      "id": "32d9bc85-edd2-46d6-bf5b-03bdc3c56540",
      "name": "Version Update Process",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 911248991,
          "mode": "list",
          "cachedResultName": "prompt_management",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=911248991"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "prompt_name": "='research_main_v' + (parseFloat($('Current Prompt Reading').item.json['version'].replace('v', '')) + 0.1).toFixed(1)",
            "current_prompt_text": "=$('Prompt Improvement').item.json.text",
            "version": "='v' + (parseFloat($('Current Prompt Reading').item.json['version'].replace('v', '')) + 0.1).toFixed(1)",
            "update_date": "=new Date().toLocaleString('en-US', { timeZone: 'America/New_York' })",
            "improvement_reason": "Automatic improvement by AI self-learning",
            "is_active": "TRUE",
            "character_limit": "1800"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "prompt_name",
              "displayName": "prompt_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_prompt_text",
              "displayName": "current_prompt_text",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "version",
              "displayName": "version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "update_date",
              "displayName": "update_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "improvement_reason",
              "displayName": "improvement_reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "is_active",
              "displayName": "is_active",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "character_limit",
              "displayName": "character_limit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        2240,
        260
      ],
      "id": "7981f658-463a-4374-9773-76ca7a7f94ea",
      "name": "Improved Prompt Save",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "=ğŸ“‹ This week's prompt evaluation: Current version is sufficient âœ¨\n\nCurrent prompts are working well for research, so no improvements needed this week! ğŸ¤–ğŸ’•",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1620,
        440
      ],
      "id": "03cbfab1-55cb-4b28-8d4b-baaf07d74eba",
      "name": "Status Maintenance Message",
      "webhookId": "c6b60df9-f871-403d-a744-7735f976c476",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $node['Config Object Creation'].json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "=âš ï¸ Error occurred in this week's evaluation\n\nResults were unclear, so maintaining current version for safety! Will try again next week ğŸ¤–ğŸ’­",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1600,
        620
      ],
      "id": "108e5477-6ad0-4a21-b232-4ce17b05e6b2",
      "name": "Assessment Error Message",
      "webhookId": "c6b60df9-f871-403d-a744-7735f976c476",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AI Research Agent Configuration",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 705924613,
          "mode": "list",
          "cachedResultName": "learning_data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=705924613"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "learning_date": "={{ $('Learning Result Save').item.json.learning_date }}",
            "improvement_judgment": "= {{ $('Improvement Necessity Assessment').item.json.text }}"
          },
          "matchingColumns": [
            "learning_date"
          ],
          "schema": [
            {
              "id": "learning_date",
              "displayName": "learning_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "learning_content",
              "displayName": "learning_content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "improvement_judgment",
              "displayName": "improvement_judgment",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "prompt_version",
              "displayName": "prompt_version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        1280,
        100
      ],
      "id": "5f9c3c2a-3b58-46a8-b4ff-532ec031ed7e",
      "name": "Assessment Result Recording",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Config Reading",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Learning Analysis",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Prompt Improvement",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Improvement Necessity Assessment",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Research History Reading": {
      "main": [
        [
          {
            "node": "Research History Object Creation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Learning Start Notification": {
      "main": [
        [
          {
            "node": "Research History Reading",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Config Reading": {
      "main": [
        [
          {
            "node": "Config Object Creation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Config Object Creation": {
      "main": [
        [
          {
            "node": "Learning Start Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Research History Object Creation": {
      "main": [
        [
          {
            "node": "Current Prompt Reading",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Current Prompt Reading": {
      "main": [
        [
          {
            "node": "Learning Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Learning Analysis": {
      "main": [
        [
          {
            "node": "Learning Result Save",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Learning Result Save": {
      "main": [
        [
          {
            "node": "Improvement Necessity Assessment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Improvement Necessity Assessment": {
      "main": [
        [
          {
            "node": "Assessment Result Recording",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Improvement Decision Switch": {
      "main": [
        [
          {
            "node": "Prompt Improvement",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Status Maintenance Message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Assessment Error Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prompt Improvement": {
      "main": [
        [
          {
            "node": "Learning Content Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Learning Content Notification": {
      "main": [
        [
          {
            "node": "Version Update Process",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Version Update Process": {
      "main": [
        [
          {
            "node": "Improved Prompt Save",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Assessment Result Recording": {
      "main": [
        [
          {
            "node": "Improvement Decision Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "e2d53214-da8b-464f-9eed-2bec3cf00fac",
  "meta": {
    "instanceId": "66a6ede234f1f050a2478dff25d508f032dcf1098c62d8ee0c4a03453d1946cc"
  },
  "id": "Dtv6119HvkFKuq9L",
  "tags": []
}