{
  "name": "reserch_workflow_jp",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 15
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -960,
        20
      ],
      "id": "71549ed7-9917-40d3-a95f-dc60defbab49",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "claude-sonnet-4-20250514",
          "cachedResultName": "Claude 4 Sonnet"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        600,
        200
      ],
      "id": "7a7805ae-758d-4be8-a37a-9b94019ac7ef",
      "name": "Anthropic Chat Model",
      "credentials": {
        "anthropicApi": {
          "id": "ThLg5qkcjtu1d3nA",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "getAll",
        "guildId": {
          "__rl": true,
          "value": "={{ $json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $json.settings.discord_research_channel_id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -460,
        20
      ],
      "id": "0bc279e8-4086-4c92-87e5-0b1a747490f1",
      "name": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦–",
      "webhookId": "66ed886c-92ee-4067-91e3-0d57e4122dae",
      "retryOnFail": true,
      "executeOnce": false,
      "alwaysOutputData": false,
      "notesInFlow": false,
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "075317e9-ea2c-41e5-aed2-bdffa3420cb8",
              "leftValue": "={{ $('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦–').all().some(msg => \n   !$('å‡¦ç†æ¸ˆã¿ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š').all().find(row => row.json.message_id === msg.json.id) && \n   !msg.json.author.bot \n) }}",
              "rightValue": "=",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -160,
        20
      ],
      "id": "b343f78e-ab67-421a-bd6a-bdf027017590",
      "name": "æ–°è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ¤å®š"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_result_channel_id }}",
          "mode": "id"
        },
        "content": "=ğŸ“ ã€Œ{{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}ã€ã®èª¿æŸ»ã‚’é–‹å§‹ã—ã¾ã™ï¼\n\nğŸ‘¤ ä¾é ¼è€…: {{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.author.global_name }}({{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.author.username }})\nğŸ”— å…ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: https://discord.com/channels/{{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}/{{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_research_channel_id }}/{{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.id }}\n\nèª¿æŸ»å®Œäº†ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€œâœ¨",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        160,
        0
      ],
      "id": "ca00aeb5-b933-4c38-9733-bd97c8e3d6db",
      "name": "èª¿æŸ»é–‹å§‹é€šçŸ¥",
      "webhookId": "69af0fc6-0c1e-466f-8d46-b1a69724ab49",
      "executeOnce": true,
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://www.googleapis.com/customsearch/v1",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.google_search_api_key }}"
            },
            {
              "name": "cx",
              "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.google_search_engine_id }}"
            },
            {
              "name": "q",
              "value": "={{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        320,
        0
      ],
      "id": "120f2561-554e-4f67-992d-a0e611d93a94",
      "name": "Webæ¤œç´¢å®Ÿè¡Œ"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.current_prompt_text }}\n\n## ğŸ“‹ èª¿æŸ»ä¾é ¼\nãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ä¾é ¼: ã€Œ{{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}ã€\n\nğŸ” **Webæ¤œç´¢çµæœ**\nä»¥ä¸‹ã¯æœ€æ–°ã®Webæ¤œç´¢çµæœã§ã™ï¼š\n{{ JSON.stringify($('Webæ¤œç´¢å®Ÿè¡Œ').item.json.items, null, 2) }}\n\n## ğŸ“‹ å‡ºåŠ›åˆ¶é™\nâ€»èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã¯{{ $json[\"character_limit\"] }}æ–‡å­—ä»¥å†…ã§ç°¡æ½”ã«ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚\nâ€»è¦ç‚¹ã‚’çµã£ã¦ã€æœ€ã‚‚é‡è¦ãªæƒ…å ±ã®ã¿ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚\nâ€»èª­ã¿ã‚„ã™ãã€å®Ÿç”¨çš„ãªå†…å®¹ã«é›†ç´„ã—ã¦ãã ã•ã„ã€‚",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        600,
        0
      ],
      "id": "2042e350-bfe1-4bc4-88f3-4d9cc32426a0",
      "name": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ»å®Ÿè¡Œ"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.notion_database_id }}",
          "mode": "id"
        },
        "title": "={{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "èª¿æŸ»æ—¥æ™‚|rich_text",
              "textContent": "={{ new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}"
            },
            {
              "key": "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹|select",
              "selectValue": "å®Œäº†"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json.text }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        900,
        0
      ],
      "id": "55ebd1ff-1998-47df-8e20-5616b8a38b6a",
      "name": "èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ",
      "credentials": {
        "notionApi": {
          "id": "986XXgY0M092gLHH",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_result_channel_id }}",
          "mode": "id"
        },
        "content": "=âœ… ã€Œ{{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}ã€ã®èª¿æŸ»ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\nğŸ“‹ çµæœã¯Notionã«ä¿å­˜ã•ã‚Œã¾ã—ãŸ\nğŸ”— èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ: {{ $('èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ').item.json.url }}\nãŠç–²ã‚Œæ§˜ã§ã—ãŸã€œâœ¨",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        120,
        360
      ],
      "id": "cfc734c7-314b-43f6-90af-5dde095a2631",
      "name": "èª¿æŸ»å®Œäº†é€šçŸ¥",
      "webhookId": "368068bb-1ce8-4e34-859a-f3e301bdd487",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "config",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "key": "boredom_level",
            "value": "0"
          },
          "matchingColumns": [
            "key"
          ],
          "schema": [
            {
              "id": "key",
              "displayName": "key",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "value",
              "displayName": "value",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        460,
        360
      ],
      "id": "a0b34989-08f8-4f27-98da-0252e3250fc2",
      "name": "é€€å±ˆãƒ¬ãƒ™ãƒ«ãƒªã‚»ãƒƒãƒˆ",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "config",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "key",
              "lookupValue": "boredom_level"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -920,
        240
      ],
      "id": "27b1025f-3b7e-49b5-902c-4140224a2fef",
      "name": "é€€å±ˆãƒ¬ãƒ™ãƒ«å–å¾—",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "config",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "value": "={{ $('é€€å±ˆãƒ¬ãƒ™ãƒ«å–å¾—').item.json['value'] + 1 }}",
            "key": "boredom_level"
          },
          "matchingColumns": [
            "key"
          ],
          "schema": [
            {
              "id": "key",
              "displayName": "key",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "value",
              "displayName": "value",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -780,
        240
      ],
      "id": "58bf5681-f276-4c7f-9a58-18865028f282",
      "name": "é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "ğŸ’¤ ãŠç–²ã‚Œæ§˜ã§ã™ã€œä»Šæ—¥ã¯èª¿æŸ»ä¾é ¼ãŒãªã„ã¿ãŸã„ã§ã™ã­âœ¨\nä½•ã‹æ°—ã«ãªã‚‹ã“ã¨ãŒã‚ã£ãŸã‚‰ã€ã„ã¤ã§ã‚‚å£°ã‚’ã‹ã‘ã¦ãã ã•ã„ã­ï¼",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -420,
        240
      ],
      "id": "1986b452-2bc7-4801-a9e7-0b0123ffe0fd",
      "name": "24æ™‚é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
      "webhookId": "7e3a27e5-6d37-49d4-be4b-4054271a4b2e",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "ğŸ¥º ã¡ã‚‡ã£ã¨é€€å±ˆã—ã¦ã¾ã™...ä½•ã‹èª¿ã¹ç‰©ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -420,
        400
      ],
      "id": "bad2c7fc-08af-4787-9a72-8b9165893ac6",
      "name": "72æ™‚é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
      "webhookId": "7e3a27e5-6d37-49d4-be4b-4054271a4b2e",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_server_id }}",
          "mode": "id"
        },
        "channelId": {
          "__rl": true,
          "value": "={{ $('è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–').item.json.settings.discord_chat_channel_id }}",
          "mode": "id"
        },
        "content": "ğŸ¤–ğŸ’­ ãã‚ãã‚æ–°ã—ã„å•†å“ã«ã¤ã„ã¦å­¦ã³ãŸã„ã§ã™ï¼",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        -420,
        580
      ],
      "id": "989e1516-955e-4bdf-8f7c-42d0bcbb59b4",
      "name": "1é€±é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
      "webhookId": "7e3a27e5-6d37-49d4-be4b-4054271a4b2e",
      "credentials": {
        "discordBotApi": {
          "id": "imUQUuQnM7DwsNxZ",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1184196857,
          "mode": "list",
          "cachedResultName": "processed_messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=1184196857"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "message_id": "={{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.id }}",
            "content": "={{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}",
            "processed_date": "={{ new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}",
            "status": "å®Œäº†"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "message_id",
              "displayName": "message_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "content",
              "displayName": "content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "processed_date",
              "displayName": "processed_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        660,
        360
      ],
      "id": "65e5b017-2dd7-4e58-84b4-debf7296ad75",
      "name": "å‡¦ç†æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç™»éŒ²",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 234951073,
          "mode": "list",
          "cachedResultName": "research_history",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=234951073"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "research_date": "={{ new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}",
            "original_content": "={{ $('èª¿æŸ»å¯¾è±¡é¸å®š').item.json.content }}",
            "research_result": "={{ $('ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ»å®Ÿè¡Œ').item.json.text }}",
            "notion_page_url": "={{ $('èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ').item.json.url }}",
            "status": "å®Œäº†"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "research_date",
              "displayName": "research_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "original_content",
              "displayName": "original_content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "research_result",
              "displayName": "research_result",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "notion_page_url",
              "displayName": "notion_page_url",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        280,
        360
      ],
      "id": "42c3835c-c2f1-4f45-ae42-dfc163c40b19",
      "name": "èª¿æŸ»å±¥æ­´ä¿å­˜",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 911248991,
          "mode": "list",
          "cachedResultName": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=911248991"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "is_active",
              "lookupValue": "true"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        460,
        0
      ],
      "id": "905e9fdb-17b3-4de7-90b2-ecf2b734c45f",
      "name": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆèª­ã¿å–ã‚Š",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ').item.json['å€¤'] }}",
                    "rightValue": "96",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a4478c5a-6196-4c23-ac28-4b8eeca0b827"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "42ab37a0-9b57-4259-a97a-2e3fd81d96f5",
                    "leftValue": "={{ $('é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ').item.json['å€¤'] }}",
                    "rightValue": "288",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "78f8f219-a90f-4b1a-a71e-c9c87c91f0d4",
                    "leftValue": "={{ $('é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ').item.json['å€¤'] }}",
                    "rightValue": "576",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -640,
        240
      ],
      "id": "c9360bd3-48de-478d-a596-143bfc9fbb83",
      "name": "é€€å±ˆãƒ¬ãƒ™ãƒ«åˆ¤å®š"
    },
    {
      "parameters": {
        "jsCode": "// æœªå‡¦ç†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤ã„é †ã«å–å¾—\nconst processedIds = $('å‡¦ç†æ¸ˆã¿ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š').all().map(row => row.json.message_id);\n\nconst unprocessed = $('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦–').all()\n  .filter(msg => !processedIds.includes(msg.json.id) && !msg.json.author.bot)\n  .sort((a, b) => new Date(a.json.timestamp) - new Date(b.json.timestamp));\n\n// æœ€ã‚‚å¤ã„æœªå‡¦ç†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™\nreturn unprocessed.length > 0 ? [unprocessed[0]] : [];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        0
      ],
      "id": "c2372067-f70e-41e3-a4e4-fde220deb312",
      "name": "èª¿æŸ»å¯¾è±¡é¸å®š"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "config",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -800,
        20
      ],
      "id": "258765f6-5c2a-4f4b-bcee-850e9f51d73f",
      "name": "è¨­å®šèª­ã¿å–ã‚Š",
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 10å€‹ã®è¨­å®šé …ç›®ã‚’1ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¾ã¨ã‚ã‚‹\nconst settings = {};\nfor (const item of $input.all()) {\n  settings[item.json.key] = item.json.value;\n}\n\nreturn [{ settings }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -620,
        20
      ],
      "id": "bd80520c-06db-46a9-b803-2ab2923dd6ff",
      "name": "è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os",
          "mode": "list",
          "cachedResultName": "AIèª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1184196857,
          "mode": "list",
          "cachedResultName": "processed_messages",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1tE6eK5zy48iBCCxu9bW0depV49eIuWu5-DLfHZsM2Os/edit#gid=1184196857"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -300,
        20
      ],
      "id": "3d70c91c-a246-4f5b-ad1a-1ae85c84a72a",
      "name": "å‡¦ç†æ¸ˆã¿ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š",
      "executeOnce": true,
      "credentials": {
        "googleApi": {
          "id": "G1ge67ubgI1HlT2P",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// é€€å±ˆãƒ¬ãƒ™ãƒ«å–å¾—ç”¨ã®ç©ºãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ\n// å‰ã®ãƒãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ã«é–¢ä¿‚ãªãã€ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™\nreturn [{}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1060,
        240
      ],
      "id": "9a25fb0b-7d61-44b7-9dba-e1182cc2433f",
      "name": "é€€å±ˆæ™‚ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "è¨­å®šèª­ã¿å–ã‚Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ»å®Ÿè¡Œ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦–": {
      "main": [
        [
          {
            "node": "å‡¦ç†æ¸ˆã¿ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ–°è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ¤å®š": {
      "main": [
        [
          {
            "node": "èª¿æŸ»å¯¾è±¡é¸å®š",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "é€€å±ˆæ™‚ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èª¿æŸ»é–‹å§‹é€šçŸ¥": {
      "main": [
        [
          {
            "node": "Webæ¤œç´¢å®Ÿè¡Œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webæ¤œç´¢å®Ÿè¡Œ": {
      "main": [
        [
          {
            "node": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆèª­ã¿å–ã‚Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ»å®Ÿè¡Œ": {
      "main": [
        [
          {
            "node": "èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ": {
      "main": [
        [
          {
            "node": "èª¿æŸ»å®Œäº†é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èª¿æŸ»å®Œäº†é€šçŸ¥": {
      "main": [
        [
          {
            "node": "èª¿æŸ»å±¥æ­´ä¿å­˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€€å±ˆãƒ¬ãƒ™ãƒ«å–å¾—": {
      "main": [
        [
          {
            "node": "é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€€å±ˆãƒ¬ãƒ™ãƒ«å¢—åŠ ": {
      "main": [
        [
          {
            "node": "é€€å±ˆãƒ¬ãƒ™ãƒ«åˆ¤å®š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€€å±ˆãƒ¬ãƒ™ãƒ«ãƒªã‚»ãƒƒãƒˆ": {
      "main": [
        [
          {
            "node": "å‡¦ç†æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç™»éŒ²",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èª¿æŸ»å±¥æ­´ä¿å­˜": {
      "main": [
        [
          {
            "node": "é€€å±ˆãƒ¬ãƒ™ãƒ«ãƒªã‚»ãƒƒãƒˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆèª­ã¿å–ã‚Š": {
      "main": [
        [
          {
            "node": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ»å®Ÿè¡Œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€€å±ˆãƒ¬ãƒ™ãƒ«åˆ¤å®š": {
      "main": [
        [
          {
            "node": "24æ™‚é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "72æ™‚é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1é€±é–“é€€å±ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èª¿æŸ»å¯¾è±¡é¸å®š": {
      "main": [
        [
          {
            "node": "èª¿æŸ»é–‹å§‹é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šèª­ã¿å–ã‚Š": {
      "main": [
        [
          {
            "node": "è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–": {
      "main": [
        [
          {
            "node": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦–",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‡¦ç†æ¸ˆã¿ã‚·ãƒ¼ãƒˆèª­ã¿å–ã‚Š": {
      "main": [
        [
          {
            "node": "æ–°è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ¤å®š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€€å±ˆæ™‚ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ": {
      "main": [
        [
          {
            "node": "é€€å±ˆãƒ¬ãƒ™ãƒ«å–å¾—",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "8de02999-6594-4e57-8405-c2b7ef207c73",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "66a6ede234f1f050a2478dff25d508f032dcf1098c62d8ee0c4a03453d1946cc"
  },
  "id": "KOGjL51su1Ma3sQ1",
  "tags": []
}